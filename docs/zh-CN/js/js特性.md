



# 1. 对象

在js中，函数也是一个对象，其实在java中，也是可以这么理解的。在js中没有类，最新的es规范已经允许类的定义的。其实类的本质就是函数的语法糖。

## 1.1 生成对象的方式有:

1. new 一个类
2. new 一个函数
3. 直接 { }定义，其中函数不需要使用 : ，直接函数名也支持，因为这不是map。虽然js本身也提供了map对象，但其实对象本质也还是一个map。

## 1.2 属性的修改方式：

1. 普通方式就是`.`和`[]`
2. 用 等于= { 多个属性同时赋值的方式}; 同时还可以进行解构赋值，{ 多个变量} = 一个对象，会把相同名字的变量属性值进行赋值。



## 1.3 this：

​	无论哪种语言，它的意义都是代表了绑定一个对象，但是在js中比较特殊的，this指向的对象，不是固定的而是在运行期间才赋值。

 

函数中的this，是谁调用了这个函数，this就指向谁。直接脚本调用，在浏览器中是widnows。node中是null。



每个对象都有一个`bind`函数，用于动态的绑定该对象的this值是什么。每个对象还有`call`和`apply`两个函数，含义就是调用对象的构造函数，构造函数内部的this，却决于参数。

## 1.4 私有属性

现在并没有直接支持这样的功能，但是有一些api可以达到这样的目的。

# 2. 原型链

每个类都有一个`prototype`属性。这个属性是一个对象。作用是，当调用类的实例化对象的属性的时候，如果属性不存在，会查看prototype对象中是否有这个属性。就好像继承了一个类一样。**但是**，`prototype`是一个对象，而不是一个类。

一个对象有prototype属性类，这个类可能也有自己的prototype属性类，这样一层层的网上就形成了继承链。但是如果对象的类修改了，对象是不会跟着修改的。

我们无法直接修对象的prototype值，对象没有`prototype`，可能成为不可访问的私有属性了。

# 3. 事件循环

是一个队列。js中很多代码都有堵塞行为，进入队列，由另一些线程执行。

process.nextTick(() => {

 // do something

});

下一次的滴答，直接执行这个函数，而不是再继续排队。

 

nodejs中的架构和一个普通的浏览器的架构可能是很相似的，比如nodejs中的事件循环，这不是nodejs原创的，这是js的特性，js是异步的，而不是说Node才是决定异步。

## 3.1 执行栈和任务队列

js语言是个单线程的，每个线程都会有一个自己的执行栈，每个函数执行都会放入栈中，主线程中的函数，如果是异步的会进入任务队列。只有当执行栈为空的时候，才会去执行异步任务队列。

## 3.2 宏任务队列和微任务队列

任务队列有两个，**微任务队列执行完以后（全部）**，**才会执行宏任务中的一个任务**，也可以说宏任务队列会产生微任务。整个js代码可以看作一个大的宏任务。宏任务的产生来自于定时器等可以直接在主代码中，而不是函数中执行的任务函数，微任务像promise这样的需要函数才可以属于宏任务产生的微任务。

## 3.3 异步和回调

在没有promise的时候，函数只有回调，这样代码会写很长的类似then的导致很难阅读，有了promise js底层会直接返回一个promise监听这个promise的变化，可以使用await/async语法糖解决这个问题，不过要函数直接声明为 async才可以，声明了就肯定会返回以一个promise，返回的返回结果就是promise最后的then的参数值。

# 4. 二进制数据



Buffer ：这是一个按字节处理数据的对象，很多api他是默认的处理数据类型

TypeView： 数组形式的字节

DataView：和buffer同样是字节数据结构，但是支持大小端不同顺序的写入（大小端就是结构体的数据结构，字节从上还是从下写入顺序）。



nodejs的很多api还提供了stream流，所有流都是对于一个文件（也可能是网络设备）的顺序处理函数集合（类），都含有一个缓冲区，好像所有语言的流的缓冲区大小都是不固定的，包括tcp通信的流的缓冲区也是不固定的，所以才有粘包问题。

# 5. 多进程和线程

child_process和cluster（管理多个进程，分发工作）可以创建多个进程；



worker_threads 可以创建多个线程。



多进程和多线程都可以使用IPC进行通信，这样的方式传递的数据都是拷贝，而不是引用。worker_threads是支持共享引用对象的。

不管是进程还是线程都有自己的isolate和context。



# 6. 事件

EventEmitter 提供了异步的监听与回调，由于nodejs是一个异步风格的语言，这个api是一个最基本的特性。

